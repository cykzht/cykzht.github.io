(()=>{var y=(()=>{let n=null;return()=>{if(LocalSearch){if(!n){let{search:i,root:r}=window.ASYNC_CONFIG;n=new LocalSearch({path:r+i.path,top_n_per_article:i.top_n_per_article,unescape:i.unescape})}return n}}})();function d(){let{search:n,i18n:i}=window.ASYNC_CONFIG;if(n){if(!n.path){console.warn("`hexo-generator-searchdb` plugin is not installed!");return}let r=document.querySelector(".trm-search-popup"),p=document.querySelector("#trm-search-btn"),h=document.querySelector(".trm-search-btn-close"),c=document.querySelector(".trm-search-input"),o=y();n.preload&&!o.isfetched&&o.fetchData();let a=()=>{if(!o.isfetched)return;let e=c.value.trim().toLowerCase(),C=e.split(/[-\s]+/),f=document.querySelector(".trm-search-result-container"),E=document.querySelector(".trm-search-stats"),s=[];if(e.length>0&&(s=o.getResultItems(C)),s.length>0)s.sort((t,l)=>t.includedCount!==l.includedCount?l.includedCount-t.includedCount:t.hitCount!==l.hitCount?l.hitCount-t.hitCount:l.id-t.id),f.innerHTML=`<ul class="search-result-list">${s.map(t=>t.item).join("")}</ul>`,E.innerHTML=i.hits.replace(/\$\{hits}/,s.length.toString());else{let t=i.empty.replace(/\$\{query}/,e);f.innerHTML=`<div class="trm-search-empty">${t}</div>`,E.innerHTML=""}},m=()=>{r.classList.add("show"),setTimeout(()=>c.focus(),500),o.isfetched||o.fetchData()},u=function(){r.classList.remove("show")},v=function(e){e.key==="Escape"&&(u(),e.preventDefault(),e.stopPropagation())},L=function(e){e.key==="Enter"&&a()};n.trigger==="auto"?c.addEventListener("input",a):c.addEventListener("keypress",L);let w=e=>{e.target===r&&u()};h.addEventListener("click",u),p.addEventListener("click",m),window.addEventListener("keydown",v),r.addEventListener("click",w),document.addEventListener("swup:contentReplaced",()=>{p.removeEventListener("click",m),h.removeEventListener("click",u),c.removeEventListener("input",a),c.removeEventListener("keypress",L),window.removeEventListener("keydown",v),r.removeEventListener("click",w)})}}d(),window.ASYNC_CONFIG.swup&&document.addEventListener("swup:contentReplaced",function(){d()})})();
